<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/AwesomeKrieger/Geschenk/refs/heads/main/AppIcon%7Eios-marketing.png">

    <title>Top Secret Mission ‚ù§Ô∏è</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@900&display=swap" rel="stylesheet">
    
    <style>
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            overflow: hidden; background: #0c4a6e; font-family: 'Inter', sans-serif;
            touch-action: none;
        }
        canvas { display: block; width: 100vw; height: 100vh; }
        
        /* OVERLAYS */
        .overlay { 
            position: fixed; inset: 0; z-index: 100; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            background: rgba(0,0,0,0.8); backdrop-filter: blur(5px);
            padding: 20px; text-align: center;
        }
        
        .card { background: white; padding: 30px; border-radius: 40px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); max-width: 320px; }
        .btn-trigger { 
            background: #ef4444; color: white; padding: 18px 45px; 
            border-radius: 50px; font-weight: 900; border: none; 
            font-size: 1.2rem; cursor: pointer; transition: transform 0.2s;
            margin-top: 20px; pointer-events: auto;
        }
        .btn-trigger:active { transform: scale(0.95); }

        /* FINALE SCROLL SEKTION */
        #scroll-finale { display: none; width: 100%; background: white; }
        .word-section { height: 100vh; display: flex; align-items: center; justify-content: center; position: sticky; top: 0; }
        .big-word { 
            font-size: 12vw; font-weight: 900; color: #ef4444; 
            opacity: 0; transform: translateY(50px); 
            transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            text-transform: uppercase; text-align: center;
        }
        .active { opacity: 1; transform: translateY(0); }
        
        #plane-icon { position: fixed; top: 40%; left: -100px; font-size: 70px; z-index: 200; pointer-events: none; transition: top 0.2s ease-out; }
    </style>
</head>
<body>

    <div id="start-screen" class="overlay">
        <div class="card">
            <h1 class="text-3xl font-black text-blue-900 mb-4 tracking-tighter">MISSION:<br>UNBEKANNT üîí</h1>
            <p class="text-gray-600 text-sm leading-relaxed mb-4">
                Steuere das Flugzeug durch die Wolkenkratzer.<br>
                Schaffst du die Distanz, wartet eine <b>√úberraschung</b> auf dich.
            </p>
            <p class="text-red-500 font-bold mb-2 uppercase text-xs">Anforderung: 25 Punkte</p>
            <button class="btn-trigger" onclick="beginGame()">ABFLUG</button>
        </div>
    </div>

    <div id="fail-screen" class="overlay" style="display: none;">
        <div class="card">
            <h1 class="text-red-600 font-black text-3xl mb-2">CRASH! üí•</h1>
            <p class="text-gray-500 mb-6">Du warst so nah dran... Versuche es direkt nochmal!</p>
            <button class="btn-trigger" onclick="beginGame()">NEUER VERSUCH</button>
        </div>
    </div>

    <canvas id="gameCanvas"></canvas>

    <div id="scroll-finale">
        <div id="plane-icon">‚úàÔ∏è</div>
        <div class="word-section"><div class="big-word">ICH</div></div>
        <div class="word-section"><div class="big-word">ZAHLE</div></div>
        <div class="word-section"><div class="big-word">DIR</div></div>
        <div class="word-section"><div class="big-word">DEN</div></div>
        <div class="word-section"><div class="big-word">FLUG!</div></div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resize);
        resize();

        let gameRunning = false;
        let score = 0;
        const target = 25;

        const plane = { x: 60, y: 0, w: 50, h: 40, gravity: 0.5, lift: -8, velocity: 0 };
        const pipes = [];
        const pipeWidth = 70;
        const pipeGap = 200;

        function beginGame() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('fail-screen').style.display = 'none';
            score = 0;
            pipes.length = 0;
            plane.y = canvas.height / 2;
            plane.velocity = 0;
            gameRunning = true;
            requestAnimationFrame(gameLoop);
        }

        function gameLoop() {
            if (!gameRunning) return;

            // Hintergrund
            ctx.fillStyle = "#87CEEB";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Flugzeug Physik
            plane.velocity += plane.gravity;
            plane.y += plane.velocity;

            // Zeichne Flugzeug (Emoji)
            ctx.font = "45px Arial";
            ctx.fillText("‚úàÔ∏è", plane.x, plane.y);

            // Hindernis Logik
            if (pipes.length === 0 || pipes[pipes.length - 1].x < canvas.width - 280) {
                const top = Math.random() * (canvas.height - pipeGap - 100) + 50;
                pipes.push({ x: canvas.width, top: top, passed: false });
            }

            for (let i = pipes.length - 1; i >= 0; i--) {
                pipes[i].x -= 4.5;

                // Zeichne Hindernis
                ctx.fillStyle = "#0369a1"; // Dunkelblau
                ctx.fillRect(pipes[i].x, 0, pipeWidth, pipes[i].top);
                ctx.fillRect(pipes[i].x, pipes[i].top + pipeGap, pipeWidth, canvas.height);

                // Kollision
                if (plane.x + 35 > pipes[i].x && plane.x < pipes[i].x + pipeWidth) {
                    if (plane.y - 30 < pipes[i].top || plane.y + 5 > pipes[i].top + pipeGap) {
                        endGame(false);
                    }
                }

                // Score
                if (!pipes[i].passed && pipes[i].x < plane.x) {
                    pipes[i].passed = true;
                    score++;
                    if (score >= target) endGame(true);
                }

                if (pipes[i].x + pipeWidth < 0) pipes.splice(i, 1);
            }

            // Score Anzeige im Spiel
            ctx.fillStyle = "white";
            ctx.font = "900 40px Inter";
            ctx.fillText(score, canvas.width/2 - 10, 80);

            // Boden/Decke
            if (plane.y > canvas.height || plane.y < 0) endGame(false);

            requestAnimationFrame(gameLoop);
        }

        function endGame(won) {
            gameRunning = false;
            if (won) {
                canvas.style.display = 'none';
                document.getElementById('scroll-finale').style.display = 'block';
                document.body.style.overflowY = 'auto';
                document.body.style.height = 'auto';
                window.scrollTo(0, 0);
            } else {
                document.getElementById('fail-screen').style.display = 'flex';
            }
        }

        // Steuerung (Klick/Tap)
        const control = (e) => {
            if (gameRunning) {
                plane.velocity = plane.lift;
                e.preventDefault();
            }
        };
        window.addEventListener('mousedown', control);
        window.addEventListener('touchstart', control, { passive: false });

        // SCROLL FINALE ANIMATION
        window.onscroll = () => {
            const scrollPercent = window.scrollY / (document.body.offsetHeight - window.innerHeight);
            const planeIcon = document.getElementById('plane-icon');
            
            planeIcon.style.left = (scrollPercent * 130) - 15 + '%';
            planeIcon.style.top = 35 + Math.sin(scrollPercent * 15) * 8 + '%';

            const words = document.querySelectorAll('.big-word');
            words.forEach((word, i) => {
                const trigger = i / words.length;
                if (scrollPercent > trigger - 0.1) word.classList.add('active');
                else word.classList.remove('active');
            });
        };
    </script>
</body>
</html>
