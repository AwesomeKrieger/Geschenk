<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Debug Console</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #1a202c; color: #f7fafc; font-family: monospace; padding: 20px; }
        .debug-card { background: #2d3748; border-radius: 8px; padding: 15px; border: 1px solid #4a5568; margin-bottom: 20px; }
        .label { color: #a0aec0; font-size: 0.8rem; text-transform: uppercase; }
        .value { color: #63b3ed; font-size: 1.2rem; font-weight: bold; word-break: break-all; }
        .success { color: #68d391; }
        .error { color: #fc8181; }
        .raw-box { background: #000; color: #0f0; padding: 10px; border-radius: 4px; margin-top: 10px; font-size: 12px; min-height: 50px; overflow-x: auto; }
    </style>
</head>
<body>

    <h1 class="text-2xl font-bold mb-6 text-red-400">üïµÔ∏è API Zeit-Diagnose</h1>

    <div class="debug-card">
        <div class="label">Ziel-URL</div>
        <div class="value text-sm">https://time.now/developer/api/unixtime</div>
    </div>

    <div class="debug-card">
        <div class="label">HTTP Status</div>
        <div id="http-status" class="value text-yellow-400">Anfrage wird gesendet...</div>
    </div>

    <div class="debug-card">
        <div class="label">API Roh-Antwort (Raw Body)</div>
        <div id="raw-output" class="raw-box">Warte auf Daten...</div>
    </div>

    <div class="debug-card">
        <div class="label">Interpretierte Unix-Zeit</div>
        <div id="parsed-time" class="value">0</div>
    </div>

    <div class="debug-card">
        <div class="label">Differenz zu 14.02. 14:00 (Sekunden)</div>
        <div id="diff-seconds" class="value">0</div>
    </div>

    <button onclick="location.reload()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg transition">
        NEU PR√úFEN
    </button>

    <script>
        // Zielzeit: 14. Feb 2026, 14:00 MEZ
        const targetUnix = 1739538000;

        async function runDiagnostics() {
            const statusEl = document.getElementById('http-status');
            const rawEl = document.getElementById('raw-output');
            const parsedEl = document.getElementById('parsed-time');
            const diffEl = document.getElementById('diff-seconds');

            try {
                // Cache-Busting, um immer frische Zeit zu erzwingen
                const startTime = Date.now();
                const response = await fetch("https://time.now/developer/api/unixtime?nocache=" + startTime);
                
                statusEl.innerText = `${response.status} ${response.statusText}`;
                
                if (response.ok) {
                    statusEl.classList.add('success');
                    const rawData = await response.text();
                    rawEl.innerText = rawData || "[Leere Antwort]";
                    
                    const unix = parseInt(rawData.trim());
                    if (!isNaN(unix)) {
                        parsedEl.innerText = unix;
                        const diff = targetUnix - unix;
                        diffEl.innerText = diff;
                        
                        if (diff <= 0) {
                            diffEl.classList.add('success');
                            diffEl.innerHTML += " (BEREIT! ‚úÖ)";
                        }
                    } else {
                        parsedEl.innerText = "NAN (Konnte nicht als Zahl gelesen werden)";
                        parsedEl.classList.add('error');
                    }
                } else {
                    statusEl.classList.add('error');
                    rawEl.innerText = "Fehler beim Laden.";
                }

            } catch (err) {
                statusEl.innerText = "FETCH ERROR (CORS oder Offline)";
                statusEl.classList.add('error');
                rawEl.innerText = err.toString();
                console.error(err);
            }
        }

        runDiagnostics();
    </script>
</body>
</html>
